version: v1
kind: kubernetes
application: pxbbq

targets:
  eks02-prod:
    account: eks02-prod
    namespace: pxbbq
    strategy: myCanary
  #  constraints:
  #    dependsOn:
  #    - staging
  #"Migrate Prod DB To Staging":
  #  account: eks02-prod
  #  namespace: pxbbq
  #  strategy: myCanary
  #staging:
  #  account: eks01-staging
  #  namespace: pxbbq
  #  strategy: myCanary
  #  constraints:
  #    dependsOn:
  #    - "Migrate Prod DB To Staging"

manifests:
  - path: pxbbq-demo/mongodb.yaml
  - path: pxbbq-demo/pxbbq.yaml
  #- path: pxbbq-demo/migrate.yaml
  #  targets:['Migrate Prod DB To Staging']
  
strategies:
  myCanary:
    canary:
      steps:
        - setWeight:
            weight: 50
        - pause:
            untilApproved: true
        - setWeight:
            weight: 100

